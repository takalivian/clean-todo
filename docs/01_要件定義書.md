# 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名

Clean Todo - タスク管理アプリケーション

### 1.2 目的

Clean Architecture パターンに基づいた、保守性と拡張性を重視したタスク管理システムの構築

### 1.3 対象ユーザー

-   個人ユーザー（タスク管理）
-   チーム管理者（ユーザー管理）

## 2. 機能要件

### 2.1 ユーザー管理機能

#### 2.1.1 ユーザー登録

-   **機能**: 新規ユーザーアカウントの作成
-   **入力項目**:
    -   名前（必須）
    -   メールアドレス（必須、ユニーク）
    -   パスワード（必須、8 文字以上）
-   **出力**: ユーザー情報とアクセストークン

#### 2.1.2 ユーザー認証

-   **機能**: ログイン・ログアウト
-   **認証方式**: JWT（JSON Web Token）
-   **セッション管理**: トークンベース

#### 2.1.3 ユーザー情報管理

-   **機能**: プロフィール情報の閲覧・更新
-   **更新可能項目**: 名前、メールアドレス、パスワード
-   **制限**: メールアドレスの重複チェック

#### 2.1.4 ユーザー削除

-   **機能**: アカウントの論理削除（ソフトデリート）
-   **影響範囲**: 関連するタスクの表示制御

### 2.2 タスク管理機能

#### 2.2.1 タスク作成

-   **機能**: 新しいタスクの作成
-   **入力項目**:
    -   タイトル（必須、最大 255 文字）
    -   説明（任意、テキスト）
    -   ステータス（未着手/進行中/完了）
    -   期限日（任意、日時）
-   **自動設定**: 作成者情報、作成日時

#### 2.2.2 タスク一覧表示

-   **機能**: タスクの一覧表示
-   **フィルタ条件**:
    -   ステータス別
    -   ユーザー別
    -   期限日範囲
    -   キーワード検索（タイトル・説明）
-   **ソート**: 期限日、作成日、更新日
-   **ページネーション**: 1 ページあたりの表示件数設定

#### 2.2.3 タスク詳細表示

-   **機能**: 特定タスクの詳細情報表示
-   **表示項目**: 全入力項目 + 作成者、更新者、作成日時、更新日時

#### 2.2.4 タスク更新

-   **機能**: 既存タスクの情報更新
-   **更新可能項目**: 全入力項目
-   **自動更新**: 更新者情報、更新日時

#### 2.2.5 タスク完了

-   **機能**: タスクの完了処理
-   **自動設定**: ステータスを「完了」に変更、完了日時を設定

#### 2.2.6 タスク削除

-   **機能**: タスクの論理削除（ソフトデリート）
-   **復元**: 削除されたタスクの復元機能

### 2.3 システム機能

#### 2.3.1 API 仕様

-   **形式**: RESTful API
-   **データ形式**: JSON
-   **認証**: Bearer Token（JWT）

#### 2.3.2 エラーハンドリング

-   **HTTP ステータスコード**: 適切なステータスコードの返却
-   **エラーメッセージ**: 日本語での分かりやすいエラーメッセージ
-   **バリデーション**: 入力値の検証とエラー詳細の提供

## 3. 非機能要件

### 3.1 パフォーマンス

-   **レスポンス時間**: API 応答時間 500ms 以内（90%ile）
-   **同時接続数**: 100 ユーザー同時接続対応
-   **データベース**: クエリ最適化、インデックス設定

### 3.2 セキュリティ

-   **認証**: JWT による認証
-   **認可**: ユーザーは自分のタスクのみ操作可能
-   **データ保護**: パスワードのハッシュ化
-   **入力検証**: SQL インジェクション対策

### 3.3 可用性

-   **稼働率**: 99.9%以上
-   **バックアップ**: 日次データベースバックアップ
-   **ログ**: アクセスログ、エラーログの記録

### 3.4 保守性

-   **アーキテクチャ**: Clean Architecture パターン採用
-   **テスト**: 単体テスト、統合テストの実装
-   **ドキュメント**: API 仕様書、設計書の整備

## 4. 制約事項

### 4.1 技術制約

-   **フレームワーク**: Laravel 11.x
-   **PHP**: 8.2 以上
-   **データベース**: MySQL 8.0 以上
-   **認証**: JWT（Laravel Sanctum）

### 4.2 運用制約

-   **デプロイ**: GitHub Actions による自動デプロイ
-   **環境**: Docker コンテナでの実行
-   **監視**: ログ監視、パフォーマンス監視

## 5. 成功基準

### 5.1 機能面

-   全機能が仕様通りに動作
-   エラーハンドリングが適切に実装
-   セキュリティ要件を満たす

### 5.2 品質面

-   テストカバレッジ 80%以上
-   コードレビュー通過
-   パフォーマンス要件を満たす

### 5.3 運用面

-   CI/CD パイプラインが正常動作
-   監視・ログ機能が稼働
-   ドキュメントが整備済み

## 6. リスクと対策

### 6.1 技術リスク

-   **データベース負荷**: インデックス最適化、クエリ改善
-   **セキュリティ脆弱性**: 定期的なセキュリティ監査

### 6.2 運用リスク

-   **データ損失**: バックアップ・復旧手順の整備
-   **サービス停止**: 冗長化、監視体制の構築

## 7. 用語定義

| 用語               | 定義                                               |
| ------------------ | -------------------------------------------------- |
| Clean Architecture | 依存関係逆転の原則に基づくアーキテクチャパターン   |
| DTO                | Data Transfer Object、データ転送オブジェクト       |
| Use Case           | アプリケーションのビジネスロジックを表現するクラス |
| Repository         | データアクセス層の抽象化インターフェース           |
| Soft Delete        | 論理削除、データを物理的に削除せず削除フラグを設定 |
| JWT                | JSON Web Token、認証情報を含むトークン形式         |

## 8. 参考資料

-   Laravel 公式ドキュメント
-   Clean Architecture（Robert C. Martin 著）
-   RESTful API 設計ガイドライン
-   JWT 仕様書（RFC 7519）
